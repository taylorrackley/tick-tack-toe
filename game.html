<!doctype html>
<html>
  <head>
    <title>Tick Tack Toe</title>
    <style>
        table {border-spacing: 20px;}
        td {width: 100px; height: 100px; background-color: black; cursor: pointer;}
    </style>
  </head>

  <body>

    <div id="names">
        <h3 id="self"></h3>
        <h3 id="opponent"></h3>
    </div>

    <form action="" method="post">
      <label>Name</label>
      <input id="username" type="text" name="username"/>
      <input type="submit">
    </form>

    <table style="display:none;">
      <tr>
        <td id="1"></td>
        <td id="2"></td>
        <td id="3"></td>
      </tr>
      <tr>
        <td id="4"></td>
        <td id="5"></td>
        <td id="6"></td>
      </tr>
      <tr>/
        <td id="7"></td>
        <td id="8"></td>
        <td id="9"></td>
      </tr>
    </table>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>

      var username = '';
      var opponent = '';
      var room_id = '';

      $(function () {

        $('table').hide();

        var socket = io();

        // user clicked box
        $('td').click(function() {
          console.log($(this).attr('id')+" : "+room_id);
          socket.emit('box-click', {'box_id' : $(this).attr('id'), 'room_id' : room_id});
        });

        $('form').submit(function() {
          username = $('#username').val();
          socket.emit('login', {'username' : username} );
          return false;
        });

        // User logged in and load game
        socket.on('load', function() {
          $('form').hide();
          $('table').show();
        });

        // box has been clicked
        socket.on('box-click', function(data) {
            console.log("box changed: "+data.box_id);
            var color = '';
            if(data.symbol == 1) { color = 'yellow'; }
            else if(data.symbol == 2) { color = 'red'; }

            $('body').find('#'+data.box_id).css("background-color", color);
        });

        // User joins game against oppenent
        socket.on('game-join', function(data) {
            opponent = data.name;
            room_id = data.room_id;
            $('#self').text(username);
            $('#opponent').text(opponent);
        });

      });
    </script>

  </body>
</html>
